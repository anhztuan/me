<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Endpoint Manager</title>
    
    <!-- Chakra UI CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@chakra-ui/system@2.5.7/dist/chakra-ui-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@chakra-ui/react@2.8.0/dist/chakra-ui-react.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emotion/react@11.11.1/dist/emotion.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emotion/styled@11.11.0/dist/emotion.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/framer-motion@10.15.0/dist/framer-motion.min.js"></script>
    
    <!-- DaisyUI cho loading animation -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.5.0/dist/full.css" rel="stylesheet" type="text/css" />
    
    <!-- Tailwind CSS (needed for DaisyUI) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        :root {
            --chakra-colors-primary: #4299E1;
            --chakra-colors-secondary: #A0AEC0;
            --chakra-colors-success: #48BB78;
            --chakra-colors-warning: #ECC94B;
            --chakra-colors-danger: #F56565;
            --chakra-colors-background: #F7FAFC;
            --chakra-colors-card: #FFFFFF;
            --chakra-colors-text: #1A202C;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            background-color: var(--chakra-colors-background);
            color: var(--chakra-colors-text);
            margin: 0;
            padding: 0;
        }
        
        .navbar {
            background-color: var(--chakra-colors-card);
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--chakra-colors-primary);
        }
        
        .navbar-menu {
            display: flex;
            gap: 1rem;
        }
        
        .main-content {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .card {
            background-color: var(--chakra-colors-card);
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .endpoints-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .endpoint-card {
            background-color: var(--chakra-colors-card);
            border-radius: 0.5rem;
            border: 1px solid #E2E8F0;
            padding: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .endpoint-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .bottom-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--chakra-colors-card);
            display: flex;
            justify-content: center;
            padding: 0.75rem;
            box-shadow: 0 -1px 3px rgba(0,0,0,0.12);
            z-index: 1000;
        }
        
        .bottom-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 1.5rem;
            color: var(--chakra-colors-secondary);
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .bottom-menu-item.active,
        .bottom-menu-item:hover {
            color: var(--chakra-colors-primary);
        }
        
        .method-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            font-weight: bold;
            border-radius: 0.25rem;
            text-transform: uppercase;
        }
        
        .method-get {
            background-color: #BEE3F8;
            color: #2B6CB0;
        }
        
        .method-post {
            background-color: #C6F6D5;
            color: #276749;
        }
        
        .method-put {
            background-color: #FEFCBF;
            color: #975A16;
        }
        
        .method-delete {
            background-color: #FED7D7;
            color: #C53030;
        }
        
        .toast-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 2000;
        }
        
        .toast {
            min-width: 300px;
            padding: 1rem;
            border-radius: 0.375rem;
            color: white;
            margin-bottom: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            animation: slideIn 0.3s ease, fadeOut 0.5s ease 2.5s forwards;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }
        
        .toast-success {
            background-color: var(--chakra-colors-success);
        }
        
        .toast-error {
            background-color: var(--chakra-colors-danger);
        }
        
        .toast-warning {
            background-color: var(--chakra-colors-warning);
            color: #1A202C;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1500;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s linear 0.3s, opacity 0.3s ease;
        }
        
        .modal-overlay.active {
            visibility: visible;
            opacity: 1;
            transition-delay: 0s;
        }
        
        .modal-content {
            background-color: var(--chakra-colors-card);
            border-radius: 0.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 1.5rem;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-brand">
            <span id="site-title">API Endpoint Manager</span>
        </div>
        <div class="navbar-menu">
            <button id="theme-toggle" class="btn btn-outline-secondary">
                <i id="theme-icon" class="fas fa-moon"></i>
            </button>
            <button id="login-btn" class="btn btn-primary">Đăng nhập</button>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="card">
            <h1>Quản lý API Endpoint</h1>
            <p>Chào mừng đến với hệ thống quản lý API Endpoint. Hệ thống này giúp bạn quản lý và theo dõi các API Endpoint của ứng dụng web.</p>
            
            <div class="search-box" style="margin: 1.5rem 0;">
                <input type="text" id="search-input" placeholder="Tìm kiếm API endpoint..." class="form-control" style="width: 100%; padding: 0.75rem; border: 1px solid #E2E8F0; border-radius: 0.375rem;">
            </div>
            
            <div class="filters" style="margin-bottom: 1.5rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                <button class="filter-btn active" data-filter="all">Tất cả</button>
                <button class="filter-btn" data-filter="get">GET</button>
                <button class="filter-btn" data-filter="post">POST</button>
                <button class="filter-btn" data-filter="put">PUT</button>
                <button class="filter-btn" data-filter="delete">DELETE</button>
            </div>
        </div>
        
        <!-- Endpoints Grid -->
        <div class="endpoints-grid" id="endpoints-container">
            <!-- Endpoints will be loaded here -->
            <div class="loading-container" style="text-align: center; padding: 3rem 0; grid-column: 1 / -1;">
                <div class="loading loading-spinner loading-lg"></div>
                <p>Đang tải dữ liệu API Endpoints...</p>
            </div>
        </div>
    </div>
    
    <!-- Bottom Menu -->
    <div class="bottom-menu">
        <div class="bottom-menu-item active" data-section="endpoints">
            <i class="fas fa-plug"></i>
            <span>Endpoints</span>
        </div>
        <div class="bottom-menu-item" data-section="docs">
            <i class="fas fa-book"></i>
            <span>Tài liệu</span>
        </div>
        <div class="bottom-menu-item" data-section="logs">
            <i class="fas fa-history"></i>
            <span>Nhật ký</span>
        </div>
        <div class="bottom-menu-item" data-section="settings">
            <i class="fas fa-cog"></i>
            <span>Cài đặt</span>
        </div>
    </div>
    
    <!-- Toast Container for Notifications -->
    <div class="toast-container" id="toast-container"></div>
    
    <!-- Modal for Endpoint Details -->
    <div class="modal-overlay" id="endpoint-modal">
        <div class="modal-content">
            <h2 id="modal-title">Chi tiết Endpoint</h2>
            <div id="modal-content"></div>
            <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
                <button id="modal-close" class="btn">Đóng</button>
                <button id="modal-test" class="btn btn-primary" style="margin-left: 0.5rem;">Test Endpoint</button>
            </div>
        </div>
    </div>
    
    <!-- Font Awesome for icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <script>
        // Fake data for demonstration
        const apiEndpoints = [
            {
                id: 1,
                name: "Get User List",
                description: "Lấy danh sách người dùng với phân trang",
                url: "/api/users",
                method: "GET",
                parameters: [
                    { name: "page", type: "number", required: false, default: 1, description: "Số trang" },
                    { name: "limit", type: "number", required: false, default: 10, description: "Số lượng bản ghi mỗi trang" }
                ],
                responses: {
                    "200": { description: "Thành công", example: '{"users": [...], "total": 100, "page": 1, "limit": 10}' },
                    "400": { description: "Tham số không hợp lệ" },
                    "401": { description: "Chưa xác thực" }
                },
                category: "Users",
                tags: ["users", "pagination"]
            },
            {
                id: 2,
                name: "Create User",
                description: "Tạo người dùng mới",
                url: "/api/users",
                method: "POST",
                parameters: [
                    { name: "name", type: "string", required: true, description: "Tên người dùng" },
                    { name: "email", type: "string", required: true, description: "Email" },
                    { name: "password", type: "string", required: true, description: "Mật khẩu" }
                ],
                responses: {
                    "201": { description: "Đã tạo thành công", example: '{"id": 101, "name": "User name", "email": "user@example.com"}' },
                    "400": { description: "Dữ liệu không hợp lệ" },
                    "409": { description: "Email đã tồn tại" }
                },
                category: "Users",
                tags: ["users", "create"]
            },
            {
                id: 3,
                name: "Update User",
                description: "Cập nhật thông tin người dùng",
                url: "/api/users/:id",
                method: "PUT",
                parameters: [
                    { name: "id", type: "number", required: true, in: "path", description: "ID người dùng" },
                    { name: "name", type: "string", required: false, description: "Tên người dùng" },
                    { name: "email", type: "string", required: false, description: "Email" }
                ],
                responses: {
                    "200": { description: "Đã cập nhật thành công", example: '{"id": 1, "name": "Updated name", "email": "updated@example.com"}' },
                    "400": { description: "Dữ liệu không hợp lệ" },
                    "404": { description: "Không tìm thấy người dùng" }
                },
                category: "Users",
                tags: ["users", "update"]
            },
            {
                id: 4,
                name: "Delete User",
                description: "Xóa người dùng",
                url: "/api/users/:id",
                method: "DELETE",
                parameters: [
                    { name: "id", type: "number", required: true, in: "path", description: "ID người dùng" }
                ],
                responses: {
                    "204": { description: "Đã xóa thành công" },
                    "404": { description: "Không tìm thấy người dùng" },
                    "403": { description: "Không có quyền xóa" }
                },
                category: "Users",
                tags: ["users", "delete"]
            },
            {
                id: 5,
                name: "Get Products",
                description: "Lấy danh sách sản phẩm",
                url: "/api/products",
                method: "GET",
                parameters: [
                    { name: "category", type: "string", required: false, description: "Lọc theo danh mục" },
                    { name: "sort", type: "string", required: false, description: "Sắp xếp (price_asc, price_desc, newest)" }
                ],
                responses: {
                    "200": { description: "Thành công", example: '{"products": [...], "total": 50}' },
                    "400": { description: "Tham số không hợp lệ" }
                },
                category: "Products",
                tags: ["products", "listing"]
            },
            {
                id: 6,
                name: "Create Product",
                description: "Tạo sản phẩm mới",
                url: "/api/products",
                method: "POST",
                parameters: [
                    { name: "name", type: "string", required: true, description: "Tên sản phẩm" },
                    { name: "price", type: "number", required: true, description: "Giá" },
                    { name: "category", type: "string", required: true, description: "Danh mục" },
                    { name: "description", type: "string", required: false, description: "Mô tả" }
                ],
                responses: {
                    "201": { description: "Đã tạo thành công", example: '{"id": 51, "name": "Product name", "price": 99.99}' },
                    "400": { description: "Dữ liệu không hợp lệ" }
                },
                category: "Products",
                tags: ["products", "create"]
            }
        ];
        
        // DOM Elements
        const endpointsContainer = document.getElementById('endpoints-container');
        const searchInput = document.getElementById('search-input');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const bottomMenuItems = document.querySelectorAll('.bottom-menu-item');
        const modal = document.getElementById('endpoint-modal');
        const modalClose = document.getElementById('modal-close');
        const modalTest = document.getElementById('modal-test');
        const toastContainer = document.getElementById('toast-container');
        
        // Functions
        function renderEndpoints(endpoints) {
            if (!endpoints || endpoints.length === 0) {
                endpointsContainer.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">Không tìm thấy API Endpoint nào.</div>';
                return;
            }
            
            endpointsContainer.innerHTML = '';
            
            endpoints.forEach(endpoint => {
                const card = document.createElement('div');
                card.className = 'endpoint-card';
                card.setAttribute('data-id', endpoint.id);
                card.setAttribute('data-method', endpoint.method.toLowerCase());
                
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem;">
                        <span class="method-badge method-${endpoint.method.toLowerCase()}">${endpoint.method}</span>
                        <span style="color: var(--chakra-colors-secondary); font-size: 0.875rem;">${endpoint.category}</span>
                    </div>
                    <h3 style="margin: 0.5rem 0; font-size: 1.125rem; font-weight: 600;">${endpoint.name}</h3>
                    <p style="color: var(--chakra-colors-secondary); margin-bottom: 0.75rem; font-size: 0.875rem; line-height: 1.4;">${endpoint.description}</p>
                    <div style="font-family: monospace; background-color: #EDF2F7; padding: 0.5rem; border-radius: 0.25rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                        ${endpoint.url}
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 1rem;">
                        <div style="display: flex; gap: 0.5rem;">
                            ${endpoint.tags.map(tag => `
                                <span style="background-color: #E2E8F0; color: #4A5568; font-size: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem;">${tag}</span>
                            `).join('')}
                        </div>
                        <button class="view-details" data-id="${endpoint.id}">Chi tiết</button>
                    </div>
                `;
                
                endpointsContainer.appendChild(card);
            });
            
            // Add event listeners to view details buttons
            document.querySelectorAll('.view-details').forEach(button => {
                button.addEventListener('click', () => {
                    const id = parseInt(button.getAttribute('data-id'));
                    const endpoint = apiEndpoints.find(e => e.id === id);
                    if (endpoint) {
                        showEndpointDetails(endpoint);
                    }
                });
            });
        }
        
        function filterEndpoints() {
            const searchTerm = searchInput.value.toLowerCase();
            const activeFilter = document.querySelector('.filter-btn.active').getAttribute('data-filter');
            
            let filteredEndpoints = [...apiEndpoints];
            
            // Apply method filter
            if (activeFilter !== 'all') {
                filteredEndpoints = filteredEndpoints.filter(endpoint => 
                    endpoint.method.toLowerCase() === activeFilter
                );
            }
            
            // Apply search filter
            if (searchTerm) {
                filteredEndpoints = filteredEndpoints.filter(endpoint => 
                    endpoint.name.toLowerCase().includes(searchTerm) || 
                    endpoint.description.toLowerCase().includes(searchTerm) || 
                    endpoint.url.toLowerCase().includes(searchTerm) ||
                    endpoint.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                );
            }
            
            renderEndpoints(filteredEndpoints);
        }
        
        function showEndpointDetails(endpoint) {
            document.getElementById('modal-title').textContent = endpoint.name;
            
            const content = document.getElementById('modal-content');
            
            let parametersHTML = '';
            if (endpoint.parameters && endpoint.parameters.length > 0) {
                parametersHTML = `
                    <h3 style="margin: 1rem 0 0.5rem;">Tham số</h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 1px solid #E2E8F0;">
                                <th style="padding: 0.5rem;">Tên</th>
                                <th style="padding: 0.5rem;">Kiểu</th>
                                <th style="padding: 0.5rem;">Bắt buộc</th>
                                <th style="padding: 0.5rem;">Mô tả</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${endpoint.parameters.map(param => `
                                <tr style="border-bottom: 1px solid #E2E8F0;">
                                    <td style="padding: 0.5rem;">${param.name}</td>
                                    <td style="padding: 0.5rem;"><code>${param.type}</code></td>
                                    <td style="padding: 0.5rem;">${param.required ? '✅' : '❌'}</td>
                                    <td style="padding: 0.5rem;">${param.description}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
            
            let responsesHTML = '';
            if (endpoint.responses) {
                responsesHTML = `
                    <h3 style="margin: 1rem 0 0.5rem;">Responses</h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 1px solid #E2E8F0;">
                                <th style="padding: 0.5rem;">Mã</th>
                                <th style="padding: 0.5rem;">Mô tả</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${Object.entries(endpoint.responses).map(([code, response]) => `
                                <tr style="border-bottom: 1px solid #E2E8F0;">
                                    <td style="padding: 0.5rem;"><code>${code}</code></td>
                                    <td style="padding: 0.5rem;">${response.description}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                // Add example if available
                Object.entries(endpoint.responses).forEach(([code, response]) => {
                    if (response.example) {
                        responsesHTML += `
                            <h4 style="margin: 0.75rem 0 0.25rem;">Example Response (${code}):</h4>
                            <pre style="background-color: #EDF2F7; padding: 0.75rem; border-radius: 0.25rem; overflow-x: auto; font-size: 0.875rem;">${response.example}</pre>
                        `;
                    }
                });
            }
            
            content.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                    <span class="method-badge method-${endpoint.method.toLowerCase()}" style="margin-right: 0.75rem;">${endpoint.method}</span>
                    <span style="font-family: monospace; font-size: 1rem;">${endpoint.url}</span>
                </div>
                
                <p style="margin-bottom: 1rem;">${endpoint.description}</p>
                
                ${parametersHTML}
                ${responsesHTML}
                
                <div style="margin-top: 1rem;">
                    <h3 style="margin-bottom: 0.5rem;">Chi tiết khác</h3>
                    <p><strong>Danh mục:</strong> ${endpoint.category}</p>
                    <p>
                        <strong>Tags:</strong>
                        ${endpoint.tags.map(tag => `
                            <span style="background-color: #E2E8F0; color: #4A5568; font-size: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem; margin-right: 0.25rem;">${tag}</span>
                        `).join('')}
                    </p>
                </div>
            `;
            
            modal.classList.add('active');
            
            // Store current endpoint ID for test function
            modalTest.setAttribute('data-id', endpoint.id);
        }
        
        function closeModal() {
            modal.classList.remove('active');
        }
        
        function testEndpoint() {
            const id = parseInt(modalTest.getAttribute('data-id'));
            const endpoint = apiEndpoints.find(e => e.id === id);
            
            if (!endpoint) return;
            
            // Show loading state
            const originalText = modalTest.textContent;
            modalTest.innerHTML = '<span class="loading-spinner"></span> Testing...';
            modalTest.disabled = true;
            
            // Simulate API test
            setTimeout(() => {
                modalTest.innerHTML = originalText;
                modalTest.disabled = false;
                
                // Show notification
                const success = Math.random() > 0.3; // 70% chance of success for demo
                
                if (success) {
                    showToast('Test thành công! 🎉 API endpoint đang hoạt động bình thường.', 'success');
                } else {
                    showToast('Test thất bại. Không thể kết nối đến endpoint.', 'error');
                }
            }, 1500);
        }
        
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            
            toastContainer.appendChild(toast);
            
            // Remove toast after animation completes
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        function changeSection(section) {
            // For demo purposes, we'll just show a toast
            if (section !== 'endpoints') {
                showToast(`Chuyển đến phần ${section}. Tính năng đang phát triển.`, 'warning');
            }
        }
