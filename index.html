<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Management System</title>
    
    <!-- Chakra UI CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@chakra-ui/cdn@2.3.0/dist/chakra.min.js"></script>
    
    <!-- DaisyUI and Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.7.2/dist/full.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="bg-base-200 shadow-lg">
        <div class="container mx-auto px-6 py-3">
            <div class="flex items-center justify-between">
                <div class="text-xl font-bold">API Manager</div>
                <div class="flex items-center space-x-4">
                    <button class="btn btn-primary" onclick="showNotification('Welcome to API Manager!')">
                        Notifications
                    </button>
                    <a href="admin.html" class="btn btn-secondary">Admin Panel</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-6 py-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- API Endpoints List -->
            <div id="endpoints-list" class="space-y-4">
                <!-- Endpoints will be loaded here -->
            </div>
        </div>

        <!-- Loading Spinner -->
        <div id="loading" class="loading loading-spinner loading-lg"></div>
    </main>

    <!-- Bottom Menu -->
    <div class="fixed bottom-0 left-0 right-0 bg-base-200 p-4">
        <div class="flex justify-center space-x-6">
            <button class="btn btn-ghost" onclick="refreshEndpoints()">Refresh</button>
            <button class="btn btn-ghost" onclick="showStats()">Statistics</button>
            <button class="btn btn-ghost" onclick="showSettings()">Settings</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
<script>
    // Configuration and state management
let config = {
    websiteName: 'API Manager',
    apiBaseUrl: 'https://jsonplaceholder.typicode.com', // Using JSONPlaceholder for demo
    endpoints: [
        {
            id: '1',
            name: 'Get Users',
            url: 'https://jsonplaceholder.typicode.com/users',
            method: 'GET',
            status: 'Inactive'
        },
        {
            id: '2',
            name: 'Get Posts',
            url: 'https://jsonplaceholder.typicode.com/posts',
            method: 'GET',
            status: 'Inactive'
        },
        {
            id: '3',
            name: 'Get Comments',
            url: 'https://jsonplaceholder.typicode.com/comments',
            method: 'GET',
            status: 'Inactive'
        },
        {
            id: '4',
            name: 'Create Post',
            url: 'https://jsonplaceholder.typicode.com/posts',
            method: 'POST',
            status: 'Inactive'
        },
        {
            id: '5',
            name: 'Update Post',
            url: 'https://jsonplaceholder.typicode.com/posts/1',
            method: 'PUT',
            status: 'Inactive'
        }
    ]
};

// Load configuration from localStorage
function loadConfig() {
    const savedConfig = localStorage.getItem('apiManagerConfig');
    if (savedConfig) {
        config = JSON.parse(savedConfig);
    }
    updateUI();
}

// Save configuration to localStorage
function saveConfig() {
    localStorage.setItem('apiManagerConfig', JSON.stringify(config));
}

// Show Chakra UI notification
function showNotification(message, type = 'info') {
    // Wait for Chakra UI to be initialized
    if (window.chakra && window.chakra.toast) {
        window.chakra.toast({
            title: message,
            status: type,
            duration: 3000,
            isClosable: true,
            position: 'top-right'
        });
    } else {
        // Fallback to console log if Chakra UI is not available
        console.log(`${type.toUpperCase()}: ${message}`);
    }
}

// Update UI with endpoints
function updateUI() {
    const endpointsList = document.getElementById('endpoints-list');
    endpointsList.innerHTML = '';

    config.endpoints.forEach(endpoint => {
        const card = document.createElement('div');
        card.className = 'card bg-base-100 shadow-xl endpoint-card';
        card.innerHTML = `
            <div class="card-body">
                <h2 class="card-title">${endpoint.name}</h2>
                <p class="text-sm text-gray-600">${endpoint.url}</p>
                <div class="flex items-center gap-2 mt-2">
                    <span class="badge badge-${endpoint.method === 'GET' ? 'info' : endpoint.method === 'POST' ? 'success' : 'warning'}">${endpoint.method}</span>
                    <span class="badge badge-${endpoint.status === 'Active' ? 'success' : 'error'}">${endpoint.status}</span>
                </div>
                <div class="card-actions justify-end mt-4">
                    <button class="btn btn-primary btn-sm" onclick="testEndpoint('${endpoint.id}')">
                        Test
                    </button>
                </div>
            </div>
        `;
        endpointsList.appendChild(card);
    });
}

// Test endpoint
async function testEndpoint(id) {
    const endpoint = config.endpoints.find(e => e.id === id);
    if (!endpoint) return;

    showLoading();
    try {
        const response = await fetch(endpoint.url, {
            method: endpoint.method,
            headers: {
                'Content-Type': 'application/json'
            },
            body: endpoint.method !== 'GET' ? JSON.stringify({
                title: 'Test Post',
                body: 'This is a test post',
                userId: 1
            }) : undefined
        });
        
        endpoint.status = response.ok ? 'Active' : 'Error';
        showNotification(`Endpoint ${endpoint.name} tested successfully`, 'success');
        
        // Show response data
        const data = await response.json();
        console.log('Response:', data);
    } catch (error) {
        endpoint.status = 'Error';
        showNotification(`Error testing endpoint ${endpoint.name}`, 'error');
        console.error('Error:', error);
    }
    hideLoading();
    saveConfig();
    updateUI();
}

// Loading handlers
function showLoading() {
    document.getElementById('loading').style.display = 'flex';
}

function hideLoading() {
    document.getElementById('loading').style.display = 'none';
}

// Bottom menu functions
function refreshEndpoints() {
    showLoading();
    setTimeout(() => {
        updateUI();
        hideLoading();
        showNotification('Endpoints refreshed', 'success');
    }, 1000);
}

function showStats() {
    const activeEndpoints = config.endpoints.filter(e => e.status === 'Active').length;
    showNotification(`Active endpoints: ${activeEndpoints}/${config.endpoints.length}`, 'info');
}

function showSettings() {
    window.location.href = 'admin.html';
}

// Initialize after Chakra UI is loaded
window.addEventListener('load', () => {
    loadConfig();
    hideLoading();
});
</script>
